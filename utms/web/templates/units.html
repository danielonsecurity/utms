<!-- templates/units.html -->
{% extends "index.html" %}

{% block page_title %}Units{% endblock %}

{% block content %}
<div class="units-container">
  <div class="units-controls">
    <div class="search-controls">
        <div class="search-field">
            <i class="material-icons">label</i>
            <input type="text" placeholder="Search by label..." id="labelSearch">
        </div>
        <div class="search-field">
          <i class="material-icons">title</i>
          <input type="text" placeholder="Search by name..." id="nameSearch">
        </div>
    </div>
    <div class="active-filters">
      <div class="filter-label">Active filters:</div>
      <div id="activeFilters" class="filter-tags">
        <!-- Active filters will be inserted here by JavaScript -->
      </div>
      {% if active_filters %}
      <button class="btn-clear" onclick="clearFilters()">Clear All</button>
      {% endif %}
    </div>
  </div>
  <div class="sort-control">
    <select id="sortSelect" onchange="sortUnits()">
      <option value="value-asc">Value ↑</option>
      <option value="value-desc">Value ↓</option>
      <option value="label-asc">Label A-Z</option>
      <option value="label-desc">Label Z-A</option>
    </select>
  </div>    

  <div class="units-grid" id="unitsGrid">
    {% for label, unit in units.items() %}
    <div class="unit-card card" data-unit="{{ label }}">
      <div class="card-header">
        <h3 class="edit-target" data-field="label">{{ label }}</h3>
	<div class="unit-controls">
          <button class="unit-edit-btn" onclick="toggleUnitEdit('{{ label }}')" title="Edit unit">
            <i class="material-icons">edit</i>
          </button>
          <span class="edit-controls" style="display: none;">
            <button class="btn-save" onclick="saveUnitEdit('{{ label }}')">
	      <i class="material-icons">save</i>
	    </button>
            <button class="btn-cancel" onclick="cancelUnitEdit('{{ label }}')">
              <i class="material-icons">close</i>
            </button>
          </span>
	</div>      
      </div>
      <div class="card-body">
        <div class="unit-info">
          <div class="info-row">
            <span class="info-label">Name:</span>
            <span class="info-value edit-target" data-field="name">{{ unit.name }}</span>
          </div>
          <div class="info-row">
            <span class="info-label">Value:</span>
            <span class="info-value edit-target" data-field="value" data-full-value="{{ unit.value|string }}">{{ format_scientific(unit.value, max_digits=20) }}</span>
          </div>
          <div class="info-row">
            <span class="info-label">Groups:</span>
            <span class="info-value groups edit-target" data-field="groups">
              {% for group in unit.groups %}
              <span class="group-tag" >
                <span class="group-name" onclick="toggleFilter('{{ group }}')">{{ group }}</span>
                <i class="material-icons group-remove" style="display: none;">close</i>
              </span>
              {% endfor %}
              <button class="add-group-btn" style="display: none;">
                <i class="material-icons">add</i>
              </button>
            </span>
          </div>
        </div>      
      </div>
    </div>
    {% endfor %}
  </div>
</div>
{% endblock %}
